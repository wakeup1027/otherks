<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=yes" />
<title>快三开奖走势图</title>
<link rel="stylesheet" href="${BASE_PATH}css/iconfont.css"/>
<script src="${BASE_PATH}js/jquery.js"></script>
<style>
html,body{height:100%; font-size:13px; margin: 0px; padding: 0px;}
.titleTable td,.titleTable th{border-top:1px solid #f1f1f1;border-left:1px solid #f1f1f1;}
#zoushiPuture td{border-top:1px solid #f1f1f1;border-left:1px solid #f1f1f1; height:30px;}
</style>
</head>

<body>
<div style="width: 100%; background: #3E94F1; color: #fff; position: fixed; top: 0px; line-height: 50px;">
	<div style="width: 280px;  margin: 0px auto;  text-align: center;">
		<div style="float:left;font-size: 15px;">距离下次开奖：</div>
		<div id="mmBox" style="float: left; margin-left: 10px; width: 35px; height: 35px; border-radius: 35px; background: #fff; color: #3e94f1; line-height: 35px; font-size: 18px; margin-top: 8px;">--</div>
		<div style="float:left; margin-left: 5px; font-weight:700;">:</div>
		<div id="ssBox" style="float: left; margin-left: 5px; width: 35px; height: 35px; border-radius: 35px; background: #fff; color: #3e94f1; line-height: 35px; font-size: 18px; margin-top: 8px;">--</div>
		<div id="tishiBox" style="float: left; margin-left: 15px; font-size: 15px; margin-top: 2px;">开奖结束</div>
		<div style="clear:both;"></div>
	</div>
</div>
<div id="zoushiBox" style="margin:0px auto; display:block; width: 1120px;padding: 50px 0px;">
<table class="titleTable" height="61" border="0" cellpadding="0" cellspacing="0" style="text-align:center; border-right:1px solid #f1f1f1;">
  <tr>
    <td style="width:100px;" rowspan="2" scope="col">期号</td>
    <td style="width:116px;" colspan="3" rowspan="2" scope="col">开奖号码</td>
    <!--<th colspan="6" scope="col">开奖号码公布</td>-->
    <td colspan="16" scope="col">和值</td>
    <td colspan="2" scope="col">大小</td>
    <td colspan="2" scope="col">单双</td>
    <td colspan="2" scope="col">质合</td>
    <td colspan="3" scope="col">路数</td>
  </tr>
  <tr>
    <td style="width:35px">03</td>
    <td style="width:35px">04</td>
    <td style="width:35px">05</td>
    <td style="width:35px">06</td>
    <td style="width:35px">07</td>
    <td style="width:35px">08</td>
    <td style="width:35px">09</td>
    <td style="width:35px">10</td>
    <td style="width:35px">11</td>
    <td style="width:35px">12</td>
    <td style="width:35px">13</td>
    <td style="width:35px">14</td>
    <td style="width:35px">15</td>
    <td style="width:35px">16</td>
    <td style="width:35px">17</td>
    <td style="width:35px">18</td>
    <td style="width:35px">大</td>
    <td style="width:35px">小</td>
    <td style="width:35px">单</td>
    <td style="width:35px">双</td>
    <td style="width:35px">质</td>
    <td style="width:35px">合</td>
    <td style="width:35px">0路</td>
    <td style="width:35px">1路</td>
    <td style="width:35px">2路</td>
  </tr>
</table>
<table id="zoushiPuture" border="0" cellpadding="0" cellspacing="0" style="text-align:center; border-bottom:1px solid #f1f1f1; border-right:1px solid #f1f1f1;"></table>
<div id="canvasBox1"></div>
<div id="canvasBox2"></div>
<div id="canvasBox3"></div>
</div>
<style>
.ulbox li{float:left; text-align:center; width:21.25%;}
.ulbox li a{text-decoration:none; outline:none;}
</style>
<script>
$(function(){
	var showvar = true;
	$(".ulbox li").click(function(){
		if($(this).hasClass("searchBtn")){
			if(showvar){
				$("#searchKey").val("");
				$("#searchDiv").css("display","block");
				showvar = false;
				$(this).css("color","#3E94F1");
			}else{
				$("#searchDiv").css("display","none");
				showvar = true;
				$(this).css("color","#838383");
			}
			
		}else{
			$("#grueBox").css("display","block");
			var ValueStr = $(this).find("span").text();
			if(ValueStr=="50"||ValueStr==50){
				window.location.href = "${BASE_PATH}home/index.html?num=50";
			}else if(ValueStr=="100"||ValueStr==100){
				window.location.href = "${BASE_PATH}home/index.html?num=100";
			}else if(ValueStr=="200"||ValueStr==200){
				window.location.href = "${BASE_PATH}home/index.html?num=200";
			}else{
				window.location.href = "${BASE_PATH}home/index.html";
			}
		}
	});	
});
</script>
<div style="width: 100%;  background: #fff; position: fixed; z-index: 1111; bottom: 0px;">
	<ul class="ulbox" style="margin: 0px; padding: 5px 0px; list-style-type: none; line-height: 20px; box-shadow: 0px 10px 10px 10px #999;">
		<li style="color:${numStr==30?'#3E94F1':'#666'};">
			<div><i class="icon iconfont icon-yanjing"></i></div>
			<div style="font-size:13px;">显示<span>30</span>条</div>
		</li>
		<li style="color:${numStr==50?'#3E94F1':'#666'};">
			<div><i class="icon iconfont icon-yanjing"></i></div>
			<div style="font-size:13px;">显示<span>50</span>条</div>
		</li>
		<li class="searchBtn" style="width:15%">
			<div style="line-height: 40px;"><i class="icon iconfont icon-search" style="font-size: 25px;"></i></div>
		</li>
		<li style="color:${numStr==100?'#3E94F1':'#666'};">
			<div><i class="icon iconfont icon-yanjing"></i></div>
			<div style="font-size:13px;">显示<span>100</span>条</div>
		</li>
		<li style="color:${numStr==200?'#3E94F1':'#666'};">
			<div><i class="icon iconfont icon-yanjing"></i></div>
			<div style="font-size:13px;">显示<span>200</span>条</div>
		</li>
		<div style="clear:both;"></div>
	</ul>
</div>
<div id="grueBox" style="display:block; padding:10px 35px; top:35%; left:30%; position:fixed; z-index:2222; color:#fff; background: rgba(0,0,0,0.5); border-radius: 5px;">数据加载中...</div>
<div id="searchDiv" style="display:none; padding:10px; top:35%; left:10%; position:fixed; z-index:2222; color:#fff; background: #fff; border: 1px solid #eee; box-shadow: 0px 3px 10px 0px #999; border-radius: 5px;">
	<table border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td><input id="searchKey" type="text" placeholder="请输入查找期数" style="border: 0px; outline: 0px; height: 30px; color: #999; border: 1px solid #3E94F1; border-radius: 5px 0px 0px 5px; padding-left: 10px;"/></td>
			<td><button onclick="findsearch()" style="margin-left: 0px; background: #3E94F1; border: 0px; outline:none; color: #fff; padding: 8px 25px; border-radius: 0px 5px 5px 0px; height: 34px;">查&nbsp;找</button></td>
		</tr>
	</table>
</div>
<div id="searchRes" style="display:none; width:80%; padding: 10px; top:35%; left:7%; position:fixed; z-index:2222; background: #fff; border: 1px solid #eee; box-shadow: 0px 3px 10px 0px #999; border-radius: 5px;">
	<table border="0" cellspacing="0" cellpadding="10" width="100%" style="text-align: center;">
		<tr>
			<td>期数</td>
			<td style="width:80px;">开奖号码</td>
			<td>开奖时间</td>
		</tr>
		<tr id="contentTR"></tr>
		<tr>
			<td colspan="3"><button onclick="closebox()" style="background: #3E94F1; color: #fff; border: 0px;  width: 100%; padding: 10px 0px; font-size: 15px; outline: none;">确&nbsp;定</button></td>
		</tr>
	</table>
</div>
<script type="text/javascript">
var countdown=${tlong};
document.addEventListener("visibilitychange", function(){
    document.hidden ? "快三开奖走势图" : window.location.href="${BASE_PATH}home/";
});

sendemail();
//console.log(countdown);
function sendemail(){
	if(countdown<0){
		$("#mmBox").text("--");
		$("#ssBox").text("--");
		//$("#grueBox").css("display","block");
		//$("html,body").css("overflow","hidden");
    	$("#tishiBox").text("开奖结束");
	}else{
		settime();
	}
}

function settime() {
    if (countdown <= 0) { //倒计时完之后刷新整个页面
    	//$("#grueBox").css("display","block");
    	//$("html,body").css("overflow","hidden");
    	$("#tishiBox").text("开奖中...");
    	$("#mmBox").text("--");
		$("#ssBox").text("--");
    	var timer2=window.setTimeout(function(){
    		window.location.href="${BASE_PATH}home/";
			window.clearTimeout(timer2);
		},2000);
        return;
    } else {
    	//$("html,body").css("overflow","unset");
    	$("#tishiBox").text("等待开奖");
    	var mmss = fromTime(countdown);
    	countdown = parseInt(countdown)-1000;
    	var Time = mmss.split(",");
    	$("#mmBox").text((Time[0]<10?"0"+Time[0]:Time[0]));
		$("#ssBox").text((Time[1]<10?"0"+Time[1]:Time[1]));
    } 
	setTimeout(function() {settime();},1000) 
}

//把毫秒化成分和秒
function fromTime(timeNum){
	var mm = "";
	var ss = "";
	var allSS = parseInt(timeNum)/1000;
	mm = Math.floor(allSS/60);
	ss = allSS%60;
	return mm+","+ss;
}


var date = []; //随机开奖的结果集
var pointDate = []; //画图的结果集
var bigSmallDate = []; //大小的坐标结果集
var signDoubleDate = []; //单双的坐标结果集
<% if( dateList != null && dateList.~size > 0 ){ %>
	<% for(item in dateList){ %>
			date.push(formd("${item.qiNum}","${item.Num}"));
	<%}
}%>

for(var j=0;j<date.length;j++){
	var chdate = date[j].Num;
	var firstNum = chdate.substring(0,1);
	var secondNum = chdate.substring(1,2);
	var threeNum = chdate.substring(2,3);
	$("#zoushiPuture").append('<tr><td style="width:100px;">'+date[j].qiNum+'</td><td style="width:38px; background:#FFFFEE;">'+firstNum+'</td><td style="width:38px; background:#FFFFEE;">'+secondNum+'</td><td style="width:38px; background:#FFFFEE;">'+threeNum+'</td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td></tr>');

	//写开奖号码公布
	var thArr = $("#zoushiPuture").find("tr").eq(j);
	if(j%2==0){ 
		thArr.css("background","#f9f9f9");
	}
    var tdArr = thArr.find("td");
    /*tdArr.eq(writNum(firstNum)).text(firstNum);
    tdArr.eq(writNum(secondNum)).text(secondNum);
	tdArr.eq(writNum(threeNum)).text(threeNum);*/
	
	//写和值
	var allRes = parseInt(firstNum)+parseInt(secondNum)+parseInt(threeNum);
    tdArr.eq(writResult(allRes)).text(allRes);
    tdArr.eq(writResult(allRes)).css({"background":"#3E94F1","color":"#fff"});
	
	//整理画和值的线的坐标
	var helfHeight = parseInt(tdArr.eq(writResult(allRes)).height())/2;
	var helfWidth = parseInt(tdArr.eq(writResult(allRes)).width())/2;
	var Y = parseInt(tdArr.eq(writResult(allRes)).offset().top)+helfWidth; 
	var X = parseInt(tdArr.eq(writResult(allRes)).offset().left)+helfHeight; 
	pointDate.push(formPointer(X,Y));
	
	//整理画(大小)的线的坐标
	/*var bsHeight = parseInt(tdArr.eq(bigsamll(allRes)).height())/2;
	var bsWidth = parseInt(tdArr.eq(bigsamll(allRes)).width())/2;
	var bsY = parseInt(tdArr.eq(bigsamll(allRes)).offset().top)+bsWidth; 
	var bsX = parseInt(tdArr.eq(bigsamll(allRes)).offset().left)+bsHeight; 
	bigSmallDate.push(formPointer(bsX,bsY));*/
	
	//整理画(单双)的线的坐标
	/*var dsHeight = parseInt(tdArr.eq(signDouble(allRes)).height())/2;
	var dsWidth = parseInt(tdArr.eq(signDouble(allRes)).width())/2;
	var dsY = parseInt(tdArr.eq(signDouble(allRes)).offset().top)+dsWidth; 
	var dsX = parseInt(tdArr.eq(signDouble(allRes)).offset().left)+dsHeight; 
	signDoubleDate.push(formPointer(dsX,dsY));*/
	
	//写大小
	if(allRes<=10){
		tdArr.eq(21).text("小");
		tdArr.eq(21).css({"background":"#5CD38F","color":"#fff"});
	}else if(allRes>10){
		tdArr.eq(20).text("大");
		tdArr.eq(20).css({"background":"#5CD38F","color":"#fff"});
	}
	
	//写单双
	if(allRes%2==0){
		tdArr.eq(23).text("双");
		tdArr.eq(23).css({"background":"#FF9C00","color":"#fff"});
	}else{
		tdArr.eq(22).text("单");
		tdArr.eq(22).css({"background":"#FF9C00","color":"#fff"});
	}
	
	//写质合
	if(allRes==3||allRes==5||allRes==7||allRes==11||allRes==13||allRes==17){
		tdArr.eq(24).text("质");
		tdArr.eq(24).css({"background":"#F64C56","color":"#fff"});
	}else{
		tdArr.eq(25).text("合");
		tdArr.eq(25).css({"background":"#F64C56","color":"#fff"});
	}
	
	//写路数
	if(allRes%3==0){
		tdArr.eq(26).text("0");
		tdArr.eq(26).css({"background":"#9C58CC","color":"#fff"});
	}else if(allRes%3==1){
		tdArr.eq(27).text("1");
		tdArr.eq(27).css({"background":"#9C58CC","color":"#fff"});
	}else if(allRes%3==2){
		tdArr.eq(28).text("2");
		tdArr.eq(28).css({"background":"#9C58CC","color":"#fff"});
	}
}

$(function(){
	for(var i=1; i<pointDate.length; i++){
		var top1 = pointDate[i-1].y;//起点的y坐标
		var left1 = pointDate[i-1].x;//终点的x坐标
		var top2 = pointDate[i].y;//终点的y坐标
		var left2 = pointDate[i].x;//终点的x坐标
		drawLine2(left1,top1,left2,top2,(i-1),1);
	}
	$("#grueBox").css("display","none");
	//console.log(bigSmallDate);
	/*for(var i=1; i<bigSmallDate.length; i++){
		var top1 = bigSmallDate[i-1].y;//起点的y坐标
		var left1 = bigSmallDate[i-1].x;//终点的x坐标
		var top2 = bigSmallDate[i].y;//终点的y坐标
		var left2 = bigSmallDate[i].x;//终点的x坐标
		drawLine2(left1,top1,left2,top2,(i-1),2);
	}
	
	for(var i=1; i<signDoubleDate.length; i++){
		var top1 = signDoubleDate[i-1].y;//起点的y坐标
		var left1 = signDoubleDate[i-1].x;//终点的x坐标
		var top2 = signDoubleDate[i].y;//终点的y坐标
		var left2 = signDoubleDate[i].x;//终点的x坐标
		drawLine2(left1,top1,left2,top2,(i-1),3);
	}*/
});

function closebox(){
	$("#searchRes").css("display","none");
}

function findsearch(){
	var keyval = $("#searchKey").val().trim();
	$.ajax({ 
		  type:'POST', 
		  url:'${BASE_PATH}home/findqiNum', 
		  data:{"qiNum":keyval},
		  success:function(data){ 
			  if(data.msg==0){
				  $("#contentTR").html("<td style='color:#999; font-size:15px;' colspan='3'>没有找到有关结果</td>");
			  }else{
				  $("#contentTR").html("<td>"+data.resdate.qiNum+"</td><td>"+data.resdate.Num+"</td><td>"+data.resdate.creantime+"</td>");
			  }
			  $("#searchRes").css("display","block");
		  }, 
		  error:function(){ 
		    alert("系统繁忙，请稍后再试!");
		  } 
	}); 
}

function formd(qiNum, Num){
	var jsond = {};
	jsond.qiNum = qiNum;
	jsond.Num = Num;
	return jsond;
}

function bigsamll(allRes){
	if(allRes<=10){
		return 21;
	}else if(allRes>10){
		return 20;
	}
}

function signDouble(allRes){
	if(allRes%2==0){
		return 23;
	}else{
		return 22;
	}
}

function writResult(allRes){
	if(allRes==3||allRes=="3"){
		return 4;
	}else if(allRes==4||allRes=="4"){
		return 5;
	}else if(allRes==5||allRes=="5"){
		return 6;
	}else if(allRes==6||allRes=="6"){
		return 7;
	}else if(allRes==7||allRes=="7"){
		return 8;
	}else if(allRes==8||allRes=="8"){
		return 9;
	}else if(allRes==9||allRes=="9"){
		return 10;
	}else if(allRes==10||allRes=="10"){
		return 11;
	}else if(allRes==11||allRes=="11"){
		return 12;
	}else if(allRes==12||allRes=="12"){
		return 13;
	}else if(allRes==13||allRes=="13"){
		return 14;
	}else if(allRes==14||allRes=="14"){
		return 15;
	}else if(allRes==15||allRes=="15"){
		return 16;
	}else if(allRes==16||allRes=="16"){
		return 17;
	}else if(allRes==17||allRes=="17"){
		return 18;
	}else if(allRes==18||allRes=="18"){
		return 19;
	}
}

function formPointer(x,y){
	var jsond = {};
	jsond.x = x;
	jsond.y = y;
	return jsond;
}

//封装一个画线的方法
function drawLine2(x1,y1,x2,y2,index,objNum){
	var top = 0;
	var left = 0;
	var width = 0;
	var height = 0;
	var starPoint1 = 0;
	var overPoint1 = 0;
	var starPoint2 = 0;
	var overPoint2 = 0;
	if(x2>x1){
		top=y1;
		left=x1;
		width = x2-x1;
		height = y2 - y1;
		starPoint1 = 0;
		overPoint1 = 0;
		starPoint2 = width;
		overPoint2 = height;
	}else{
		top=y1;
		left=x2;
		width = x1-x2;
		height = y2 - y1;
		starPoint1 = width;
		overPoint1 = 0;
		starPoint2 = 0;
		overPoint2 = height;
	}
	//console.log(x1+","+y1+"/"+x2+","+y2+"/"+index);
	var cava = '<canvas width="'+(width+2)+'" height="'+height+'" style="position: absolute; top: '+top+'px; left: '+left+'px;"></canvas>'
	$("#canvasBox"+objNum).append(cava);
	
	var canvas=$("#canvasBox"+objNum+" canvas")[index];
	var ctx=canvas.getContext('2d');
	ctx.beginPath();
	ctx.moveTo(starPoint1,overPoint1);
	ctx.lineTo(starPoint2,overPoint2);
	ctx.strokeStyle = "#3E94F1";
	ctx.stroke();
}

$(function(){
 
$("#zoushiMap").click(function(){
	$("#zoushiBox").show();
	$("#resuBox").hide();
});

$("#reSultBtn").click(function(){
	$("#zoushiBox").hide();
	$("#resuBox").show();
});

});
</script>
</body>
</html>
